# –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏ –¥–ª—è –º–∞–ª–∏—Ö –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π

–ü–æ–≤–Ω–∏–π –Ω–∞–±—ñ—Ä —Å–∫—Ä–∏–ø—Ç—ñ–≤ —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏ –Ω–∞ –±–∞–∑—ñ Grafana Stack (Prometheus, Loki, Alertmanager) —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —ñ–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü—ñ—ó (Netdisco, FleetDM).

## –§—ñ–ª–æ—Å–æ—Ñ—ñ—è

> **–õ–æ–≥–∏ —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥, –∑–∞ —è–∫–∏–º–∏ –Ω—ñ—Ö—Ç–æ –Ω–µ —Å–ª—ñ–¥–∫—É—î ‚Äî –≥—ñ—Ä—à–µ –∑–∞ —ó—Ö –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å.**
> –í–æ–Ω–∏ —Å—Ç–≤–æ—Ä—é—é—Ç—å —Ö–∏–±–Ω–µ –≤—ñ–¥—á—É—Ç—Ç—è –±–µ–∑–ø–µ–∫–∏.
> –ö—Ä–∞—â–µ –º–∞—Ç–∏ 5 –∞–ª–µ—Ä—Ç—ñ–≤ —â–æ –ø—Ä–∞—Ü—é—é—Ç—å, –Ω—ñ–∂ 500 —â–æ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è.

### –ö–ª—é—á–æ–≤—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏

- ‚úÖ –í—Å–µ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–µ –ü–ó
- ‚úÖ 20% –∑—É—Å–∏–ª—å –¥–ª—è 80% –∑–∞—Ö–∏—Å—Ç—É
- ‚úÖ –í–∏—è–≤–ª–µ–Ω–Ω—è –≤–∞–∂–ª–∏–≤—ñ—à–µ –∑–∞ –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è
- ‚úÖ 6 –º—ñ—Å—è—Ü—ñ–≤ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ª–æ–≥—ñ–≤ (–≤–∏–º–æ–≥–∞ CERT-UA)
- ‚úÖ –ú—ñ–Ω—ñ–º—É–º false positives

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        –°–ï–†–í–ï–† –ú–û–ù–Ü–¢–û–†–ò–ù–ì–£                          ‚îÇ
‚îÇ                         (Debian 12+)                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ                    Docker Containers                         ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ Prometheus‚îÇ ‚îÇ Loki ‚îÇ ‚îÇ Grafana ‚îÇ ‚îÇ  Alertmanager    ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  :9090    ‚îÇ ‚îÇ:3100 ‚îÇ ‚îÇ :3000   ‚îÇ ‚îÇ     :9093        ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                                              ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                 ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ Netdisco  ‚îÇ ‚îÇ FleetDM  ‚îÇ                                 ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  :5000    ‚îÇ ‚îÇ  :8080   ‚îÇ                                 ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                 ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                           ‚îÇ
‚îÇ  ‚îÇ Promtail (native)   ‚îÇ ‚Üê Syslog UDP:514                          ‚îÇ
‚îÇ  ‚îÇ + Node Exporter     ‚îÇ                                           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚ñ≤                    ‚ñ≤                    ‚ñ≤
           ‚îÇ                    ‚îÇ                    ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ Win11 Pro   ‚îÇ     ‚îÇ Win Server  ‚îÇ     ‚îÇ Linux       ‚îÇ
    ‚îÇ             ‚îÇ     ‚îÇ 2025        ‚îÇ     ‚îÇ Servers     ‚îÇ
    ‚îÇ - Promtail  ‚îÇ     ‚îÇ - Promtail  ‚îÇ     ‚îÇ - Promtail  ‚îÇ
    ‚îÇ - WinExport ‚îÇ     ‚îÇ - WinExport ‚îÇ     ‚îÇ - NodeExport‚îÇ
    ‚îÇ - Sysmon    ‚îÇ     ‚îÇ - Sysmon    ‚îÇ     ‚îÇ             ‚îÇ
    ‚îÇ - Osquery   ‚îÇ     ‚îÇ - Osquery   ‚îÇ     ‚îÇ             ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è | –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è |
|-----------|-------------|-------------|
| Prometheus | –ó–±—ñ—Ä –º–µ—Ç—Ä–∏–∫ | Docker |
| Loki | –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ª–æ–≥—ñ–≤ | Docker |
| Grafana | –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è + –∞–ª–µ—Ä—Ç–∏ | Docker |
| Alertmanager | –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—è —Å–ø–æ–≤—ñ—â–µ–Ω—å | Docker |
| Netdisco | –Ü–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü—ñ—è –º–µ—Ä–µ–∂—ñ | Docker |
| FleetDM | –Ü–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü—ñ—è endpoints | Docker |
| Promtail | –ê–≥–µ–Ω—Ç –∑–±–æ—Ä—É –ª–æ–≥—ñ–≤ | Native |
| Node Exporter | –ú–µ—Ç—Ä–∏–∫–∏ Linux | Native |
| Windows Exporter | –ú–µ—Ç—Ä–∏–∫–∏ Windows | Native |
| Sysmon | –î–µ—Ç–∞–ª—å–Ω–∏–π –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ Windows | Native |

## –°–∏—Å—Ç–µ–º–Ω—ñ –≤–∏–º–æ–≥–∏

### –°–µ—Ä–≤–µ—Ä –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ú—ñ–Ω—ñ–º—É–º | –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ |
|----------|---------|---------------|
| OS | Debian 12+ | Debian 13 |
| CPU | 4 cores | 8 cores |
| RAM | 8 GB | 16 GB |
| Disk | 200 GB SSD | 500 GB SSD |
| Network | 100 Mbps | 1 Gbps |

**–§–æ—Ä–º—É–ª–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –¥–∏—Å–∫—É:**
```
Disk = (Endpoints √ó 100MB/day √ó 180 days √ó 1.5) + 50GB
```

### –ü—Ä–∏–∫–ª–∞–¥–∏:
- 10 –∫–æ–º–ø'—é—Ç–µ—Ä—ñ–≤: ~320 GB
- 50 –∫–æ–º–ø'—é—Ç–µ—Ä—ñ–≤: ~1.4 TB
- 100 –∫–æ–º–ø'—é—Ç–µ—Ä—ñ–≤: ~2.8 TB

## –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
git clone https://github.com/your-org/cybersec-monitoring.git
cd cybersec-monitoring

# –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
# .env –≤–∂–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –¥–ª—è lab environment
nano .env  # –ó–º—ñ–Ω—ñ—Ç—å –≤—Å—ñ –ø–∞—Ä–æ–ª—ñ!
```

### 2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–Ω–æ—ó —á–∞—Å—Ç–∏–Ω–∏

```bash
# –ó–∞–ø—É—Å–∫ –≥–æ–ª–æ–≤–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è
sudo ./server/01-install.sh
```

### 3. –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –Ω–∞ Windows –∫–ª—ñ—î–Ω—Ç–∞—Ö

```powershell
# –ó–∞–ø—É—Å–∫ –≤—ñ–¥ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –Ω–∞ Windows 11 (10.0.1.4)
.\windows-11-client\Deploy-Client.ps1 -LokiUrl "http://10.0.1.2:3100"
```

### 4. –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –Ω–∞ Windows —Å–µ—Ä–≤–µ—Ä–∞—Ö

```powershell
# –ó–∞–ø—É—Å–∫ –≤—ñ–¥ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –Ω–∞ Windows Server 2025 (10.0.1.3)
.\windows-server-2025\Deploy-Server.ps1 -LokiUrl "http://10.0.1.2:3100"
```

### 5. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Grafana: `http://10.0.1.2:3000`
2. –õ–æ–≥—ñ–Ω: admin / (–ø–∞—Ä–æ–ª—å –∑ .env)
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–∞—à–±–æ—Ä–¥ "Security Overview"

> **–ü—Ä–∏–º—ñ—Ç–∫–∞ —â–æ–¥–æ FleetDM:** –î–ª—è lab environment –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è self-signed —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏. 
> –ü—Ä–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ñ osquery –∞–≥–µ–Ω—Ç—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å `-Insecure`:
> ```powershell
> .\Deploy-Client.ps1 -LokiUrl "http://10.0.1.2:3100" -FleetUrl "https://10.0.1.2:8080" -FleetEnrollSecret "..." -Insecure
> ```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
cybersec-monitoring/
‚îú‚îÄ‚îÄ .env                      # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
‚îú‚îÄ‚îÄ README.md                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ LICENSE                   # –õ—ñ—Ü–µ–Ω–∑—ñ—è MIT
‚îÇ
‚îú‚îÄ‚îÄ server/                   # –°–µ—Ä–≤–µ—Ä–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞
‚îÇ   ‚îú‚îÄ‚îÄ 01-install.sh         # –ì–æ–ª–æ–≤–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è
‚îÇ   ‚îú‚îÄ‚îÄ monitoring-stack/     # Grafana, Prometheus, Loki
‚îÇ   ‚îú‚îÄ‚îÄ inventory-stack/      # Netdisco, FleetDM
‚îÇ   ‚îî‚îÄ‚îÄ promtail/             # Self-monitoring
‚îÇ
‚îú‚îÄ‚îÄ windows-common/           # –°–ø—ñ–ª—å–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏ Windows
‚îÇ   ‚îú‚îÄ‚îÄ 01-Set-AuditPolicy.ps1
‚îÇ   ‚îú‚îÄ‚îÄ 02-Enable-PowerShellLogging.ps1
‚îÇ   ‚îú‚îÄ‚îÄ 03-Install-Sysmon.ps1
‚îÇ   ‚îú‚îÄ‚îÄ 04-Install-Promtail.ps1
‚îÇ   ‚îú‚îÄ‚îÄ 05-Install-WindowsExporter.ps1
‚îÇ   ‚îî‚îÄ‚îÄ 06-Install-OsqueryAgent.ps1
‚îÇ
‚îú‚îÄ‚îÄ windows-11-client/        # –î–ª—è —Ä–æ–±–æ—á–∏—Ö —Å—Ç–∞–Ω—Ü—ñ–π
‚îÇ   ‚îú‚îÄ‚îÄ Deploy-Client.ps1
‚îÇ   ‚îî‚îÄ‚îÄ promtail-client.yml
‚îÇ
‚îú‚îÄ‚îÄ windows-server-2025/      # –î–ª—è —Å–µ—Ä–≤–µ—Ä—ñ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Deploy-Server.ps1
‚îÇ   ‚îî‚îÄ‚îÄ promtail-server.yml
‚îÇ
‚îú‚îÄ‚îÄ linux-client/             # –î–ª—è Linux —Å–∏—Å—Ç–µ–º
‚îÇ   ‚îú‚îÄ‚îÄ install-agent.sh
‚îÇ   ‚îî‚îÄ‚îÄ promtail-linux.yml
‚îÇ
‚îî‚îÄ‚îÄ testing/                  # –¢–µ—Å—Ç–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É
    ‚îî‚îÄ‚îÄ detection-testing/    # –û–±'—î–¥–Ω–∞–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è—Ö
        ‚îú‚îÄ‚îÄ windows/          # 6 PowerShell —Ç–µ—Å—Ç—ñ–≤
        ‚îî‚îÄ‚îÄ kali/             # 7 Bash —Ç–µ—Å—Ç—ñ–≤
```

## –î–∞—à–±–æ—Ä–¥–∏

| –î–∞—à–±–æ—Ä–¥ | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
|---------|-------------|
| 00-security-overview | –ó–∞–≥–∞–ª—å–Ω–∏–π –æ–≥–ª—è–¥ –±–µ–∑–ø–µ–∫–∏ |
| 01-windows-security | Windows Security Events + PowerShell + Scheduled Tasks |
| 02-linux-security | Linux Security |
| 03-network-overview | –ú–µ—Ä–µ–∂–∞ + Lateral Movement (SMB/RDP/WinRM) |
| 04-authentication | –õ–æ–≥—ñ–Ω–∏, RDP |
| 05-alerts-summary | –ê–∫—Ç–∏–≤–Ω—ñ –∞–ª–µ—Ä—Ç–∏ |
| 06-inventory-status | –Ü–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü—ñ—è —Ö–æ—Å—Ç—ñ–≤ |
| 07-morning-coffee | –©–æ–¥–µ–Ω–Ω–∏–π –æ–≥–ª—è–¥ –±–µ–∑–ø–µ–∫–∏ (15 —Ö–≤) |

## –ö—Ä–∏—Ç–∏—á–Ω—ñ Event IDs

### –ù–∞–π–≤–∞–∂–ª–∏–≤—ñ—à—ñ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –∞—Ç–∞–∫:

| Event ID | –û–ø–∏—Å | –ö—Ä–∏—Ç–∏—á–Ω—ñ—Å—Ç—å |
|----------|------|-------------|
| 1102 | –ñ—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç—É –æ—á–∏—â–µ–Ω–æ | üî¥ Critical |
| 4624 | –£—Å–ø—ñ—à–Ω–∏–π –≤—Ö—ñ–¥ | üü° Medium |
| 4625 | –ù–µ–≤–¥–∞–ª–∏–π –≤—Ö—ñ–¥ | üü† High |
| 4672 | –í—Ö—ñ–¥ –∑ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏ –∞–¥–º—ñ–Ω–∞ | üü† High |
| 4720 | –°—Ç–≤–æ—Ä–µ–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ | üî¥ Critical |
| 4732 | –î–æ–¥–∞–Ω–æ –¥–æ –ª–æ–∫–∞–ª—å–Ω–æ—ó –≥—Ä—É–ø–∏ | üî¥ Critical |
| 4697 | –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Å–µ—Ä–≤—ñ—Å | üî¥ Critical |
| 4698 | –°—Ç–≤–æ—Ä–µ–Ω–æ scheduled task | üî¥ Critical |
| 7045 | –ù–æ–≤–∏–π —Å–µ—Ä–≤—ñ—Å (System log) | üî¥ Critical |

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–¢–µ—Å—Ç–æ–≤—ñ —Å–∫—Ä–∏–ø—Ç–∏ –∑–≥—Ä—É–ø–æ–≤–∞–Ω—ñ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è—Ö –≤ `testing/detection-testing/`.

### Windows —Ç–µ—Å—Ç–∏ (PowerShell)

```powershell
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É —Ç–µ—Å—Ç—ñ–≤
cd testing\detection-testing\windows

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—ñ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
.\01-Test-Authentication.ps1

# –î–æ—Å—Ç—É–ø–Ω—ñ —Ç–µ—Å—Ç–∏:
# 01-Test-Authentication.ps1  - Failed logins, privilege escalation
# 02-Test-UserManagement.ps1  - User/group creation, admin access
# 03-Test-Persistence.ps1     - Services, scheduled tasks
# 04-Test-DefenseEvasion.ps1  - Log clearing, policy changes
# 05-Test-ProcessExecution.ps1 - Suspicious process creation
# 06-Test-LateralMovement.ps1 - SMB, RDP, WinRM connections
```

### Kali —Ç–µ—Å—Ç–∏ (Bash)

```bash
cd testing/detection-testing/kali

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—ñ–≤ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è
./01-test-scanning.sh

# –î–æ—Å—Ç—É–ø–Ω—ñ —Ç–µ—Å—Ç–∏:
# 01-test-scanning.sh      - Port/network scanning
# 02-test-bruteforce.sh    - Password attacks
# 03-test-webattacks.sh    - SQL injection, XSS
# 04-test-exploitation.sh  - Metasploit framework
# 05-test-postexploit.sh   - Post-exploitation
# 06-test-exfiltration.sh  - Data exfiltration
# 07-test-persistence.sh   - Backdoors, C2
```

## Lab Environment

| Host | IP | OS | Credentials |
|------|----|----|-------------|
| Monitoring Server | 10.0.1.2 | Debian 13 | monadmin / Mon!123admin |
| Domain Controller | 10.0.1.3 | Windows Server 2025 | LAB\monadmin / Mon!123admin |
| Windows Client | 10.0.1.4 | Windows 11 | LAB\pc / Mon!123admin |
| Kali Linux | 10.0.1.5 | Kali 2024.x | kali / kali |

**Domain:** LAB (lab.local)

## –õ—ñ—Ü–µ–Ω–∑—ñ—è

MIT License - –¥–∏–≤. —Ñ–∞–π–ª [LICENSE](LICENSE)
